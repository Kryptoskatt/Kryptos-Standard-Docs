"use strict";(globalThis.webpackChunkkryptos_docs=globalThis.webpackChunkkryptos_docs||[]).push([[885],{3182:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>w,contentTitle:()=>I,default:()=>$,frontMatter:()=>S,metadata:()=>t,toc:()=>U});const t=JSON.parse('{"id":"authentication/oauth","title":"OAuth 2.0","description":"Use OAuth 2.0 authorization code flow with PKCE to access user portfolio data with their consent.","source":"@site/docs/authentication/oauth.md","sourceDirName":"authentication","slug":"/authentication/oauth","permalink":"/authentication/oauth","draft":false,"unlisted":false,"editUrl":"https://github.com/kryptoskatt/Kryptos-Standard-Docs/edit/main/docs/docs/authentication/oauth.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"oauth","title":"OAuth 2.0","sidebar_position":1},"sidebar":"docs","previous":{"title":"Base URL","permalink":"/base-url"},"next":{"title":"API Key","permalink":"/authentication/api-key"}}');var s=r(4848),i=r(8453),c=r(6540),o=r(4164),l=r(7559),d=r(3104),a=r(6347),h=r(205),u=r(7485),p=r(1682),x=r(679);function j(e){return c.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,c.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function f(e){const{values:n,children:r}=e;return(0,c.useMemo)(()=>{const e=n??function(e){return j(e).map(({props:{value:e,label:n,attributes:r,default:t}})=>({value:e,label:n,attributes:r,default:t}))}(r);return function(e){const n=(0,p.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,r])}function _({value:e,tabValues:n}){return n.some(n=>n.value===e)}function g({queryString:e=!1,groupId:n}){const r=(0,a.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,u.aZ)(t),(0,c.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(r.location.search);n.set(t,e),r.replace({...r.location,search:n.toString()})},[t,r])]}function m(e){const{defaultValue:n,queryString:r=!1,groupId:t}=e,s=f(e),[i,o]=(0,c.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!_({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const r=n.find(e=>e.default)??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s})),[l,d]=g({queryString:r,groupId:t}),[a,u]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[r,t]=(0,x.Dv)(n);return[r,(0,c.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),p=(()=>{const e=l??a;return _({value:e,tabValues:s})?e:null})();(0,h.A)(()=>{p&&o(p)},[p]);return{selectedValue:i,selectValue:(0,c.useCallback)(e=>{if(!_({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),u(e)},[d,u,s]),tabValues:s}}var b=r(2303);const k={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function v({className:e,block:n,selectedValue:r,selectValue:t,tabValues:i}){const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,d.a_)(),a=e=>{const n=e.currentTarget,s=c.indexOf(n),o=i[s].value;o!==r&&(l(n),t(o))},h=e=>{let n=null;switch(e.key){case"Enter":a(e);break;case"ArrowRight":{const r=c.indexOf(e.currentTarget)+1;n=c[r]??c[0];break}case"ArrowLeft":{const r=c.indexOf(e.currentTarget)-1;n=c[r]??c[c.length-1];break}}n?.focus()};return(0,s.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:t})=>(0,s.jsx)("li",{role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:e=>{c.push(e)},onKeyDown:h,onClick:a,...t,className:(0,o.A)("tabs__item",k.tabItem,t?.className,{"tabs__item--active":r===e}),children:n??e},e))})}function C({lazy:e,children:n,selectedValue:r}){const t=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=t.find(e=>e.props.value===r);return e?(0,c.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,s.jsx)("div",{className:"margin-top--md",children:t.map((e,n)=>(0,c.cloneElement)(e,{key:n,hidden:e.props.value!==r}))})}function y(e){const n=m(e);return(0,s.jsxs)("div",{className:(0,o.A)(l.G.tabs.container,"tabs-container",k.tabList),children:[(0,s.jsx)(v,{...n,...e}),(0,s.jsx)(C,{...n,...e})]})}function E(e){const n=(0,b.A)();return(0,s.jsx)(y,{...e,children:j(e.children)},String(n))}const R={tabItem:"tabItem_Ymn6"};function T({children:e,hidden:n,className:r}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,o.A)(R.tabItem,r),hidden:n,children:e})}const S={id:"oauth",title:"OAuth 2.0",sidebar_position:1},I="OAuth 2.0 Authentication",w={},U=[{value:"Endpoints",id:"endpoints",level:2},{value:"Available Scopes",id:"available-scopes",level:2},{value:"Core Scopes",id:"core-scopes",level:3},{value:"Data Scopes (Granular Read/Write)",id:"data-scopes-granular-readwrite",level:3},{value:"Authorization Flow",id:"authorization-flow",level:2},{value:"Step 1: Register Your Client",id:"step-1-register-your-client",level:3},{value:"Step 2: Generate PKCE Parameters",id:"step-2-generate-pkce-parameters",level:3},{value:"Step 3: Redirect to Authorization",id:"step-3-redirect-to-authorization",level:3},{value:"Step 4: Exchange Code for Token",id:"step-4-exchange-code-for-token",level:3},{value:"Step 5: Call APIs",id:"step-5-call-apis",level:3},{value:"Required Headers",id:"required-headers",level:2},{value:"Code Examples",id:"code-examples",level:2},{value:"Token Refresh",id:"token-refresh",level:2},{value:"Token Revocation",id:"token-revocation",level:2},{value:"UserInfo Endpoint",id:"userinfo-endpoint",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"OIDC Error Codes",id:"oidc-error-codes",level:3},{value:"Error Handling Example",id:"error-handling-example",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"Token Response",id:"token-response",level:2},{value:"Rate Limits",id:"rate-limits",level:2}];function A(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"oauth-20-authentication",children:"OAuth 2.0 Authentication"})}),"\n",(0,s.jsx)(n.p,{children:"Use OAuth 2.0 authorization code flow with PKCE to access user portfolio data with their consent."}),"\n",(0,s.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"URL"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Authorization"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/auth"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Token"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/token"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UserInfo"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/userinfo"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Revocation"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/token/revocation"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Introspection"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/token/introspection"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Discovery"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/.well-known/openid_configuration"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"JWKS"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://connect.kryptos.io/oidc/jwks"})})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"available-scopes",children:"Available Scopes"}),"\n",(0,s.jsx)(n.h3,{id:"core-scopes",children:"Core Scopes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Scope"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"openid"})}),(0,s.jsx)(n.td,{children:"Basic OpenID Connect access (required)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"profile"})}),(0,s.jsx)(n.td,{children:"User profile (name, picture, updated_at)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"email"})}),(0,s.jsx)(n.td,{children:"Email address and verified status"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"offline_access"})}),(0,s.jsx)(n.td,{children:"Allow refresh tokens for offline data access"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"data-scopes-granular-readwrite",children:"Data Scopes (Granular Read/Write)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Resource"}),(0,s.jsx)(n.th,{children:"Read Scope"}),(0,s.jsx)(n.th,{children:"Write Scope"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Holdings"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"holdings:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"holdings:write"})}),(0,s.jsx)(n.td,{children:"Portfolio holdings and balances"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Transactions"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"transactions:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"transactions:write"})}),(0,s.jsx)(n.td,{children:"Transaction history and trades"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DeFi Portfolio"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"defi-portfolio:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"defi-portfolio:write"})}),(0,s.jsx)(n.td,{children:"DeFi positions, staking, LP pools"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"NFT Portfolio"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"nft-portfolio:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"nft-portfolio:write"})}),(0,s.jsx)(n.td,{children:"NFT collections and metadata"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Ledger"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ledger:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ledger:write"})}),(0,s.jsx)(n.td,{children:"Accounting ledger entries"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Tax"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tax:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tax:write"})}),(0,s.jsx)(n.td,{children:"Tax calculations and reports"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Integrations"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"integrations:read"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"integrations:write"})}),(0,s.jsx)(n.td,{children:"Third-party exchange connections"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"authorization-flow",children:"Authorization Flow"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-register-your-client",children:"Step 1: Register Your Client"}),"\n",(0,s.jsx)(n.p,{children:"Contact the Kryptos team to register your application and receive:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"client_id"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"client_secret"})}),"\n",(0,s.jsx)(n.li,{children:"Approved scopes"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Email:"})," ",(0,s.jsx)(n.a,{href:"mailto:support@kryptos.io",children:"support@kryptos.io"})]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-generate-pkce-parameters",children:"Step 2: Generate PKCE Parameters"}),"\n",(0,s.jsx)(n.p,{children:"PKCE (Proof Key for Code Exchange) adds security to the authorization flow, protecting against code interception attacks."}),"\n",(0,s.jsxs)(E,{children:[(0,s.jsx)(T,{value:"js",label:"JavaScript",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Generate code verifier (random string 43-128 chars)\nfunction generateCodeVerifier() {\n  const array = new Uint8Array(32);\n  crypto.getRandomValues(array);\n  return base64UrlEncode(array);\n}\n\n// Generate code challenge (SHA-256 hash of verifier)\nasync function generateCodeChallenge(verifier) {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(verifier);\n  const hash = await crypto.subtle.digest('SHA-256', data);\n  return base64UrlEncode(new Uint8Array(hash));\n}\n\nfunction base64UrlEncode(buffer) {\n  return btoa(String.fromCharCode(...buffer))\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_')\n    .replace(/=+$/, '');\n}\n"})})}),(0,s.jsx)(T,{value:"python",label:"Python",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import secrets\nimport hashlib\nimport base64\n\ndef generate_pkce():\n    """Generate PKCE code verifier and challenge"""\n    verifier = secrets.token_urlsafe(32)\n    challenge = base64.urlsafe_b64encode(\n        hashlib.sha256(verifier.encode()).digest()\n    ).decode().rstrip(\'=\')\n    return verifier, challenge\n'})})}),(0,s.jsx)(T,{value:"php",label:"PHP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"function generatePKCE() {\n    $verifier = bin2hex(random_bytes(32));\n    $challenge = rtrim(strtr(base64_encode(\n        hash('sha256', $verifier, true)\n    ), '+/', '-_'), '=');\n    return ['verifier' => $verifier, 'challenge' => $challenge];\n}\n"})})})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code_verifier"})}),(0,s.jsx)(n.td,{children:"Random string (43-128 chars) sent during token exchange"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code_challenge"})}),(0,s.jsx)(n.td,{children:"Base64url encoded SHA-256 hash of the code verifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code_challenge_method"})}),(0,s.jsxs)(n.td,{children:["Always ",(0,s.jsx)(n.code,{children:"S256"})," for SHA-256"]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"step-3-redirect-to-authorization",children:"Step 3: Redirect to Authorization"}),"\n",(0,s.jsx)(n.p,{children:"Redirect the user to the authorization endpoint:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GET https://connect.kryptos.io/oidc/auth?\n  response_type=code&\n  client_id=YOUR_CLIENT_ID&\n  redirect_uri=YOUR_REDIRECT_URI&\n  scope=openid profile email holdings:read transactions:read defi-portfolio:read nft-portfolio:read offline_access&\n  state=RANDOM_STATE&\n  code_challenge=CODE_CHALLENGE&\n  code_challenge_method=S256\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example Scope Combinations:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Read-only:"})," ",(0,s.jsx)(n.code,{children:"openid profile holdings:read transactions:read"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Full access:"})," ",(0,s.jsx)(n.code,{children:"openid profile holdings:read holdings:write transactions:read transactions:write"})]}),"\n"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"response_type"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Always ",(0,s.jsx)(n.code,{children:"code"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"client_id"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Your client ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"redirect_uri"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Your callback URL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"scope"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Space-separated list of scopes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"state"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Random string to prevent CSRF attacks"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code_challenge"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"PKCE code challenge"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"code_challenge_method"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["Always ",(0,s.jsx)(n.code,{children:"S256"})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"step-4-exchange-code-for-token",children:"Step 4: Exchange Code for Token"}),"\n",(0,s.jsxs)(n.p,{children:["After the user authorizes, they're redirected to your ",(0,s.jsx)(n.code,{children:"redirect_uri"})," with an authorization code. Exchange it for tokens:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://connect.kryptos.io/oidc/token \\\n  -H "Content-Type: application/x-www-form-urlencoded" \\\n  -d "grant_type=authorization_code" \\\n  -d "code=AUTH_CODE" \\\n  -d "redirect_uri=YOUR_REDIRECT_URI" \\\n  -d "client_id=YOUR_CLIENT_ID" \\\n  -d "client_secret=YOUR_CLIENT_SECRET" \\\n  -d "code_verifier=CODE_VERIFIER"\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "access_token": "eyJhbGciOiJSUzI1NiIs...",\n  "token_type": "Bearer",\n  "expires_in": 86400,\n  "refresh_token": "def50200...",\n  "id_token": "eyJhbGciOiJSUzI1NiIs...",\n  "scope": "openid profile holdings:read transactions:read"\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{title:"Token Lifetimes",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Access Token:"})," 24 hours"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Refresh Token:"})," 30 days"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ID Token:"})," 24 hours"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authorization Code:"})," 10 minutes"]}),"\n"]})}),"\n",(0,s.jsx)(n.h3,{id:"step-5-call-apis",children:"Step 5: Call APIs"}),"\n",(0,s.jsx)(n.p,{children:"Use the access token to call APIs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X GET https://connect.kryptos.io/api/v1/holdings \\\n  -H "Authorization: Bearer ACCESS_TOKEN" \\\n  -H "X-Client-Id: YOUR_CLIENT_ID" \\\n  -H "X-Client-Secret: YOUR_CLIENT_SECRET"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"required-headers",children:"Required Headers"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Header"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Authorization"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Bearer {access_token}"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"X-Client-Id"})}),(0,s.jsx)(n.td,{children:"Your client ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"X-Client-Secret"})}),(0,s.jsx)(n.td,{children:"Your client secret"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"code-examples",children:"Code Examples"}),"\n",(0,s.jsxs)(E,{children:[(0,s.jsx)(T,{value:"js",label:"JavaScript",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"class KryptosClient {\n  constructor(clientId, clientSecret) {\n    this.clientId = clientId;\n    this.clientSecret = clientSecret;\n    this.baseUrl = 'https://connect.kryptos.io';\n    this.accessToken = null;\n  }\n\n  // Generate PKCE parameters\n  async generatePKCE() {\n    const array = new Uint8Array(32);\n    crypto.getRandomValues(array);\n    const verifier = this.base64UrlEncode(array);\n    \n    const encoder = new TextEncoder();\n    const data = encoder.encode(verifier);\n    const hash = await crypto.subtle.digest('SHA-256', data);\n    const challenge = this.base64UrlEncode(new Uint8Array(hash));\n    \n    return { verifier, challenge };\n  }\n\n  base64UrlEncode(buffer) {\n    return btoa(String.fromCharCode(...buffer))\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n  }\n\n  // Get authorization URL\n  // Scopes use granular :read and :write format\n  getAuthUrl(redirectUri, codeChallenge, scopes = [\n    'openid',              // Required - basic OIDC\n    'profile',             // Read: name, picture\n    'email',               // Read: email address\n    'holdings:read',       // Read: portfolio holdings\n    'transactions:read',   // Read: transaction history\n    'defi-portfolio:read', // Read: DeFi positions\n    'nft-portfolio:read',  // Read: NFT collections\n    'offline_access'       // Enable refresh tokens\n  ]) {\n    const params = new URLSearchParams({\n      response_type: 'code',\n      client_id: this.clientId,\n      redirect_uri: redirectUri,\n      scope: scopes.join(' '),\n      state: Math.random().toString(36).substring(7),\n      code_challenge: codeChallenge,\n      code_challenge_method: 'S256'\n    });\n    return `${this.baseUrl}/oidc/auth?${params}`;\n  }\n\n  // Exchange authorization code for tokens\n  async exchangeCode(code, redirectUri, codeVerifier) {\n    const response = await fetch(`${this.baseUrl}/oidc/token`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n      body: new URLSearchParams({\n        grant_type: 'authorization_code',\n        code,\n        redirect_uri: redirectUri,\n        client_id: this.clientId,\n        client_secret: this.clientSecret,\n        code_verifier: codeVerifier\n      })\n    });\n    \n    const tokens = await response.json();\n    this.accessToken = tokens.access_token;\n    return tokens;\n  }\n\n  // Get user holdings\n  async getHoldings() {\n    const response = await fetch(`${this.baseUrl}/api/v1/holdings`, {\n      headers: {\n        'Authorization': `Bearer ${this.accessToken}`,\n        'X-Client-Id': this.clientId,\n        'X-Client-Secret': this.clientSecret\n      }\n    });\n    return response.json();\n  }\n\n  // Get user info\n  async getUserInfo() {\n    const response = await fetch(`${this.baseUrl}/api/v1/userinfo`, {\n      headers: {\n        'Authorization': `Bearer ${this.accessToken}`,\n        'X-Client-Id': this.clientId,\n        'X-Client-Secret': this.clientSecret\n      }\n    });\n    return response.json();\n  }\n}\n\n// Usage\nconst client = new KryptosClient('your_client_id', 'your_client_secret');\n\n// 1. Generate PKCE and redirect user\nconst { verifier, challenge } = await client.generatePKCE();\nsessionStorage.setItem('code_verifier', verifier);\nwindow.location.href = client.getAuthUrl('http://localhost:3000/callback', challenge);\n\n// 2. Handle callback\nconst urlParams = new URLSearchParams(window.location.search);\nconst code = urlParams.get('code');\nconst storedVerifier = sessionStorage.getItem('code_verifier');\nawait client.exchangeCode(code, 'http://localhost:3000/callback', storedVerifier);\n\n// 3. Get data\nconst holdings = await client.getHoldings();\n"})})}),(0,s.jsx)(T,{value:"python",label:"Python",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import requests\nimport secrets\nimport hashlib\nimport base64\nfrom urllib.parse import urlencode\n\nclass KryptosClient:\n    def __init__(self, client_id, client_secret):\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.base_url = 'https://connect.kryptos.io'\n        self.access_token = None\n\n    def generate_pkce(self):\n        \"\"\"Generate PKCE code verifier and challenge\"\"\"\n        verifier = secrets.token_urlsafe(32)\n        challenge = base64.urlsafe_b64encode(\n            hashlib.sha256(verifier.encode()).digest()\n        ).decode().rstrip('=')\n        return verifier, challenge\n\n    def get_auth_url(self, redirect_uri, code_challenge, scopes=['openid', 'profile', 'holdings:read', 'transactions:read', 'offline_access']):\n        params = {\n            'response_type': 'code',\n            'client_id': self.client_id,\n            'redirect_uri': redirect_uri,\n            'scope': ' '.join(scopes),\n            'state': secrets.token_urlsafe(16),\n            'code_challenge': code_challenge,\n            'code_challenge_method': 'S256'\n        }\n        return f\"{self.base_url}/oidc/auth?{urlencode(params)}\"\n\n    def exchange_code(self, code, redirect_uri, code_verifier):\n        data = {\n            'grant_type': 'authorization_code',\n            'code': code,\n            'redirect_uri': redirect_uri,\n            'client_id': self.client_id,\n            'client_secret': self.client_secret,\n            'code_verifier': code_verifier\n        }\n        \n        response = requests.post(\n            f\"{self.base_url}/oidc/token\",\n            data=data,\n            headers={'Content-Type': 'application/x-www-form-urlencoded'}\n        )\n        \n        tokens = response.json()\n        self.access_token = tokens['access_token']\n        return tokens\n\n    def get_holdings(self):\n        headers = {\n            'Authorization': f'Bearer {self.access_token}',\n            'X-Client-Id': self.client_id,\n            'X-Client-Secret': self.client_secret\n        }\n        response = requests.get(f\"{self.base_url}/api/v1/holdings\", headers=headers)\n        return response.json()\n\n    def get_userinfo(self):\n        headers = {\n            'Authorization': f'Bearer {self.access_token}',\n            'X-Client-Id': self.client_id,\n            'X-Client-Secret': self.client_secret\n        }\n        response = requests.get(f\"{self.base_url}/api/v1/userinfo\", headers=headers)\n        return response.json()\n\n# Usage\nclient = KryptosClient('your_client_id', 'your_client_secret')\n\n# 1. Generate PKCE and get authorization URL\nverifier, challenge = client.generate_pkce()\nauth_url = client.get_auth_url('http://localhost:8000/callback', challenge)\nprint(f\"Visit: {auth_url}\")\n# Store verifier securely for later use\n\n# 2. After user authorizes, exchange code\n# tokens = client.exchange_code(code, 'http://localhost:8000/callback', verifier)\n\n# 3. Get data\n# holdings = client.get_holdings()\n"})})}),(0,s.jsx)(T,{value:"php",label:"PHP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"<?php\nclass KryptosClient {\n    private $clientId;\n    private $clientSecret;\n    private $baseUrl = 'https://connect.kryptos.io';\n    private $accessToken;\n    \n    public function __construct($clientId, $clientSecret) {\n        $this->clientId = $clientId;\n        $this->clientSecret = $clientSecret;\n    }\n    \n    public function generatePKCE() {\n        $verifier = bin2hex(random_bytes(32));\n        $challenge = rtrim(strtr(base64_encode(\n            hash('sha256', $verifier, true)\n        ), '+/', '-_'), '=');\n        return ['verifier' => $verifier, 'challenge' => $challenge];\n    }\n    \n    public function getAuthUrl($redirectUri, $codeChallenge, $scopes = ['openid', 'profile', 'holdings:read', 'transactions:read', 'offline_access']) {\n        $params = http_build_query([\n            'response_type' => 'code',\n            'client_id' => $this->clientId,\n            'redirect_uri' => $redirectUri,\n            'scope' => implode(' ', $scopes),\n            'state' => bin2hex(random_bytes(16)),\n            'code_challenge' => $codeChallenge,\n            'code_challenge_method' => 'S256'\n        ]);\n        return $this->baseUrl . '/oidc/auth?' . $params;\n    }\n    \n    public function exchangeCode($code, $redirectUri, $codeVerifier) {\n        $data = [\n            'grant_type' => 'authorization_code',\n            'code' => $code,\n            'redirect_uri' => $redirectUri,\n            'client_id' => $this->clientId,\n            'client_secret' => $this->clientSecret,\n            'code_verifier' => $codeVerifier\n        ];\n        \n        $ch = curl_init();\n        curl_setopt($ch, CURLOPT_URL, $this->baseUrl . '/oidc/token');\n        curl_setopt($ch, CURLOPT_POST, true);\n        curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n        curl_setopt($ch, CURLOPT_HTTPHEADER, [\n            'Content-Type: application/x-www-form-urlencoded'\n        ]);\n        \n        $response = curl_exec($ch);\n        curl_close($ch);\n        \n        $tokens = json_decode($response, true);\n        $this->accessToken = $tokens['access_token'];\n        return $tokens;\n    }\n    \n    public function getHoldings() {\n        return $this->makeApiCall('/api/v1/holdings');\n    }\n    \n    public function getUserInfo() {\n        return $this->makeApiCall('/api/v1/userinfo');\n    }\n    \n    private function makeApiCall($endpoint) {\n        $ch = curl_init();\n        curl_setopt($ch, CURLOPT_URL, $this->baseUrl . $endpoint);\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n        curl_setopt($ch, CURLOPT_HTTPHEADER, [\n            'Authorization: Bearer ' . $this->accessToken,\n            'X-Client-Id: ' . $this->clientId,\n            'X-Client-Secret: ' . $this->clientSecret\n        ]);\n        \n        $response = curl_exec($ch);\n        curl_close($ch);\n        \n        return json_decode($response, true);\n    }\n}\n\n// Usage\n$client = new KryptosClient('your_client_id', 'your_client_secret');\n\n// 1. Generate PKCE and redirect to authorization\n$pkce = $client->generatePKCE();\n$_SESSION['code_verifier'] = $pkce['verifier'];\nheader('Location: ' . $client->getAuthUrl('http://localhost/callback.php', $pkce['challenge']));\n\n// 2. In callback.php\n// $tokens = $client->exchangeCode($_GET['code'], 'http://localhost/callback.php', $_SESSION['code_verifier']);\n\n// 3. Get data\n// $holdings = $client->getHoldings();\n?>\n"})})}),(0,s.jsx)(T,{value:"go",label:"Go",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "crypto/rand"\n    "crypto/sha256"\n    "encoding/base64"\n    "encoding/json"\n    "fmt"\n    "io"\n    "net/http"\n    "net/url"\n    "strings"\n)\n\ntype KryptosClient struct {\n    ClientID     string\n    ClientSecret string\n    BaseURL      string\n    AccessToken  string\n}\n\nfunc NewKryptosClient(clientID, clientSecret string) *KryptosClient {\n    return &KryptosClient{\n        ClientID:     clientID,\n        ClientSecret: clientSecret,\n        BaseURL:      "https://connect.kryptos.io",\n    }\n}\n\nfunc (c *KryptosClient) GeneratePKCE() (verifier, challenge string) {\n    b := make([]byte, 32)\n    rand.Read(b)\n    verifier = base64.RawURLEncoding.EncodeToString(b)\n    \n    h := sha256.Sum256([]byte(verifier))\n    challenge = base64.RawURLEncoding.EncodeToString(h[:])\n    return\n}\n\nfunc (c *KryptosClient) GetAuthURL(redirectURI, codeChallenge string, scopes []string) string {\n    params := url.Values{\n        "response_type":         {"code"},\n        "client_id":             {c.ClientID},\n        "redirect_uri":          {redirectURI},\n        "scope":                 {strings.Join(scopes, " ")},\n        "state":                 {"random_state"},\n        "code_challenge":        {codeChallenge},\n        "code_challenge_method": {"S256"},\n    }\n    return fmt.Sprintf("%s/oidc/auth?%s", c.BaseURL, params.Encode())\n}\n\nfunc (c *KryptosClient) ExchangeCode(code, redirectURI, codeVerifier string) error {\n    data := url.Values{\n        "grant_type":    {"authorization_code"},\n        "code":          {code},\n        "redirect_uri":  {redirectURI},\n        "client_id":     {c.ClientID},\n        "client_secret": {c.ClientSecret},\n        "code_verifier": {codeVerifier},\n    }\n    \n    resp, err := http.PostForm(c.BaseURL+"/oidc/token", data)\n    if err != nil {\n        return err\n    }\n    defer resp.Body.Close()\n    \n    var tokens map[string]interface{}\n    json.NewDecoder(resp.Body).Decode(&tokens)\n    c.AccessToken = tokens["access_token"].(string)\n    return nil\n}\n\nfunc (c *KryptosClient) GetHoldings() (map[string]interface{}, error) {\n    return c.makeAPICall("/api/v1/holdings")\n}\n\nfunc (c *KryptosClient) makeAPICall(endpoint string) (map[string]interface{}, error) {\n    req, _ := http.NewRequest("GET", c.BaseURL+endpoint, nil)\n    req.Header.Set("Authorization", "Bearer "+c.AccessToken)\n    req.Header.Set("X-Client-Id", c.ClientID)\n    req.Header.Set("X-Client-Secret", c.ClientSecret)\n    \n    resp, err := http.DefaultClient.Do(req)\n    if err != nil {\n        return nil, err\n    }\n    defer resp.Body.Close()\n    \n    body, _ := io.ReadAll(resp.Body)\n    var result map[string]interface{}\n    json.Unmarshal(body, &result)\n    return result, nil\n}\n\n// Usage\nfunc main() {\n    client := NewKryptosClient("your_client_id", "your_client_secret")\n    \n    // 1. Generate PKCE\n    verifier, challenge := client.GeneratePKCE()\n    \n    // 2. Get auth URL\n    authURL := client.GetAuthURL("http://localhost:8080/callback", challenge, \n        []string{"openid", "profile", "holdings:read", "transactions:read", "offline_access"})\n    fmt.Println("Visit:", authURL)\n    \n    // 3. After callback, exchange code\n    // client.ExchangeCode(code, "http://localhost:8080/callback", verifier)\n    \n    // 4. Get holdings\n    // holdings, _ := client.GetHoldings()\n}\n'})})}),(0,s.jsx)(T,{value:"curl",label:"cURL",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Step 1: Generate PKCE (use a tool or library)\n# code_verifier: random 43-128 character string\n# code_challenge: base64url(sha256(code_verifier))\n\n# Step 2: Redirect user to authorization URL\n# Open in browser:\n# https://connect.kryptos.io/oidc/auth?\\\n#   response_type=code&\\\n#   client_id=YOUR_CLIENT_ID&\\\n#   redirect_uri=YOUR_REDIRECT_URI&\\\n#   scope=openid%20profile%20holdings:read%20transactions:read%20offline_access&\\\n#   state=RANDOM_STATE&\\\n#   code_challenge=CODE_CHALLENGE&\\\n#   code_challenge_method=S256\n\n# Step 3: Exchange code for token\ncurl -X POST https://connect.kryptos.io/oidc/token \\\n  -H "Content-Type: application/x-www-form-urlencoded" \\\n  -d "grant_type=authorization_code" \\\n  -d "code=AUTH_CODE_FROM_CALLBACK" \\\n  -d "redirect_uri=YOUR_REDIRECT_URI" \\\n  -d "client_id=YOUR_CLIENT_ID" \\\n  -d "client_secret=YOUR_CLIENT_SECRET" \\\n  -d "code_verifier=YOUR_CODE_VERIFIER"\n\n# Step 4: Call API with access token\ncurl -X GET https://connect.kryptos.io/api/v1/holdings \\\n  -H "Authorization: Bearer ACCESS_TOKEN" \\\n  -H "X-Client-Id: YOUR_CLIENT_ID" \\\n  -H "X-Client-Secret: YOUR_CLIENT_SECRET"\n\n# Get user info\ncurl -X GET https://connect.kryptos.io/api/v1/userinfo \\\n  -H "Authorization: Bearer ACCESS_TOKEN" \\\n  -H "X-Client-Id: YOUR_CLIENT_ID" \\\n  -H "X-Client-Secret: YOUR_CLIENT_SECRET"\n'})})})]}),"\n",(0,s.jsx)(n.h2,{id:"token-refresh",children:"Token Refresh"}),"\n",(0,s.jsx)(n.p,{children:"Access tokens expire after 24 hours. Use refresh tokens to get new ones:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://connect.kryptos.io/oidc/token \\\n  -H "Content-Type: application/x-www-form-urlencoded" \\\n  -d "grant_type=refresh_token" \\\n  -d "client_id=YOUR_CLIENT_ID" \\\n  -d "client_secret=YOUR_CLIENT_SECRET" \\\n  -d "refresh_token=YOUR_REFRESH_TOKEN"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"token-revocation",children:"Token Revocation"}),"\n",(0,s.jsx)(n.p,{children:"Revoke tokens when user logs out:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://connect.kryptos.io/oidc/token/revocation \\\n  -H "Content-Type: application/x-www-form-urlencoded" \\\n  -d "token=TOKEN_TO_REVOKE" \\\n  -d "client_id=YOUR_CLIENT_ID" \\\n  -d "client_secret=YOUR_CLIENT_SECRET"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"userinfo-endpoint",children:"UserInfo Endpoint"}),"\n",(0,s.jsx)(n.p,{children:"Get user information using access token:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X GET https://connect.kryptos.io/oidc/userinfo \\\n  -H "Authorization: Bearer ACCESS_TOKEN"\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "sub": "firebase_user_uid",\n  "name": "John Doe",\n  "email": "john@example.com",\n  "email_verified": true,\n  "picture": "https://example.com/avatar.jpg",\n  "updated_at": 1642248600,\n  "holdings_access": true,\n  "transactions_access": true,\n  "defi_portfolio_access": true,\n  "nft_portfolio_access": false,\n  "ledger_access": false,\n  "tax_access": true,\n  "integrations_access": true\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.h3,{id:"oidc-error-codes",children:"OIDC Error Codes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Error Code"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invalid_request"})}),(0,s.jsx)(n.td,{children:"Request is missing required parameter"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invalid_client"})}),(0,s.jsx)(n.td,{children:"Client authentication failed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invalid_grant"})}),(0,s.jsx)(n.td,{children:"Authorization grant is invalid or expired"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unauthorized_client"})}),(0,s.jsx)(n.td,{children:"Client not authorized for this grant type"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unsupported_grant_type"})}),(0,s.jsx)(n.td,{children:"Grant type not supported"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invalid_scope"})}),(0,s.jsx)(n.td,{children:"Requested scope is invalid"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"access_denied"})}),(0,s.jsx)(n.td,{children:"User denied authorization"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invalid_token"})}),(0,s.jsx)(n.td,{children:"Token is invalid or expired"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"error-handling-example",children:"Error Handling Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function makeApiCall(endpoint, accessToken, refreshToken) {\n  const response = await fetch(endpoint, {\n    headers: { 'Authorization': `Bearer ${accessToken}` }\n  });\n  \n  if (response.status === 401) {\n    // Token expired - try refresh\n    const newTokens = await refreshAccessToken(refreshToken);\n    return makeApiCall(endpoint, newTokens.access_token, newTokens.refresh_token);\n  }\n  \n  if (response.status === 403) {\n    // Insufficient scope\n    throw new Error('Insufficient permissions for this resource');\n  }\n  \n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(`API Error: ${error.error} - ${error.error_description}`);\n  }\n  \n  return response.json();\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Always use PKCE"})," - Protects against authorization code interception"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Store secrets securely"})," - Never expose client secrets in frontend code"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use HTTPS"})," - Always use secure connections"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validate state parameter"})," - Prevent CSRF attacks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Handle token expiration"})," - Implement refresh token logic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Request minimal scopes"})," - Only request necessary permissions"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"token-response",children:"Token Response"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"access_token"})}),(0,s.jsx)(n.td,{children:"JWT token for API authentication"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"id_token"})}),(0,s.jsx)(n.td,{children:"OIDC ID token with user claims"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"token_type"})}),(0,s.jsxs)(n.td,{children:["Always ",(0,s.jsx)(n.code,{children:"Bearer"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"expires_in"})}),(0,s.jsx)(n.td,{children:"Token validity in seconds (86400 = 24hrs)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"refresh_token"})}),(0,s.jsx)(n.td,{children:"Token for obtaining new access tokens"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"scope"})}),(0,s.jsx)(n.td,{children:"Granted scopes"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"rate-limits",children:"Rate Limits"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint Type"}),(0,s.jsx)(n.th,{children:"Limit"}),(0,s.jsx)(n.th,{children:"Window"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Token Endpoint"}),(0,s.jsx)(n.td,{children:"100 requests"}),(0,s.jsx)(n.td,{children:"per minute"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"UserInfo Endpoint"}),(0,s.jsx)(n.td,{children:"1000 requests"}),(0,s.jsx)(n.td,{children:"per hour"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Other OIDC"}),(0,s.jsx)(n.td,{children:"200 requests"}),(0,s.jsx)(n.td,{children:"per hour"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Rate limits are per client ID. Exceeding limits returns HTTP 429 with ",(0,s.jsx)(n.code,{children:"retry_after"})," header."]})]})}function $(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(A,{...e})}):A(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>o});var t=r(6540);const s={},i=t.createContext(s);function c(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);